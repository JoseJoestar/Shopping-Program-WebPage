<!DOCTYPE html>
<html>

<head>
    <title>jQuery Test</title>
    <meta charset="UTF-8" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <link href="./cropper.css" rel="stylesheet" type="text/css" />
    <link href="styles.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">


</head>

<body>

    <!--TODO: Attributes for input type=file -->
    <input type="file" id="file-browser" name="fileUpload[]" multiple />

    <h3 id="modeSelect"></h3>
    <div class="img-container">


        <img id="tempImg" style="display:none" />
    </div>
    <div id = "croppedImage"></div>
    <div>(To Move Image itself, double click the dark area)</div>

    <button id="uploadButton">Upload Button</button>
    <span>
        <br>
        <button id="aspect16x9Button">16/9</button>
        <button id="aspect4x3Button">4:3</button>
        <button id="aspect1x1Button">1:1</button>
        <button id="aspect2x3Button">2:3</button>
        <button id="aspectFreeButton">Free</button>
        <span>

            <script type="text/javascript" src="cropper.js"></script>

            <script>
                var modeSelect = document.getElementById("modeSelect")
                var tempImg = document.getElementById("tempImg");
                var cropper;
                document.getElementById("file-browser")
                    .addEventListener("change", function (event) {

                        var file = event.target.files[0];
                        var urlObject = URL.createObjectURL(file);
                        tempImg.src = urlObject;

                        new Cropper(tempImg, {
                            autoCrop: false,


                            ready: function () {
                                cropper = this.cropper;
                                this.cropper.crop();
                            }
                        });
                    });

                // 1. Add a "Upload" button
                // 2. on click, get blob (log on console) 

                document.getElementById("uploadButton")
                    .addEventListener("click", function () {
                        cropper.getCroppedCanvas().toBlob(function (blob) {
                            console.log(blob);
                            var getCanvas = cropper.getCroppedCanvas({
                                maxWidth: 4096,
                                maxHeight: 4096,
                                width: 160,
                                height: 90,
                                minWidth: 256,
                                minHeight: 256,
                                maxWidth: 4096,
                                maxHeight: 4096,
                                fillColor: '#fff',
                                imageSmoothingEnabled: false,
                                imageSmoothingQuality: 'high',
                            });
                            document.getElementById("croppedImage").append(getCanvas);
                        })
                    })

                document.getElementById("aspect16x9Button").addEventListener("click", function () {
                    cropper.setAspectRatio(16 / 9);
                    modeSelect.textContent = "Aspect ratio set to 16:9"
                })

                document.getElementById("aspect4x3Button").addEventListener("click", function () {
                    cropper.setAspectRatio(4 / 3);
                    modeSelect.textContent = "Aspect ratio set to 4:3"
                })

                document.getElementById("aspect1x1Button").addEventListener("click", function () {
                    cropper.setAspectRatio(1);
                    modeSelect.textContent = "Aspect ratio set to 1:1"
                })

                document.getElementById("aspect2x3Button").addEventListener("click", function () {
                    cropper.setAspectRatio(2 / 3);
                    modeSelect.textContent = "Aspect ratio set to 2:3"
                })

                document.getElementById("aspectFreeButton").addEventListener("click", function () {
                    cropper.setAspectRatio(NaN);
                    modeSelect.textContent = "Aspect ratio set to Free Mode"
                })


            </script>






</body>

</html>